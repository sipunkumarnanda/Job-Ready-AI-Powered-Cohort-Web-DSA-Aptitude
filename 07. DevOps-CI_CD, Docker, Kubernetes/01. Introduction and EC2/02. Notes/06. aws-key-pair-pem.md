

# ğŸ”‘ AWS Key Pair & `.pem` File Explained

---

## 1ï¸âƒ£ What is a Key Pair in AWS? ğŸ—ï¸

A **key pair** in AWS is a **cryptographic set of credentials** used to **securely connect** to your EC2 instances.

It consists of two parts:

1. **Public Key** (stored in AWS)
2. **Private Key** (downloaded as a `.pem` file)

**Purpose:**

* The public key is installed on your EC2 instance.
* The private key (`.pem`) is kept by you and used to **authenticate via SSH**.
* Together, they allow **secure password-less login** to your Linux instances.

> Think of it like a **lock and key**: AWS keeps the lock (public key) on the instance, and you hold the key (`.pem`) to unlock it. ğŸ”

---

## 2ï¸âƒ£ What is a `.pem` File? ğŸ“„

* `.pem` = **Privacy Enhanced Mail** file format.
* In AWS, it **contains your private key** in plain text.
* You **download it only once** when creating the key pair.
* It is required to **SSH into your EC2 instance**.

**Important points:**

* Keep it safe! If you lose it, you **cannot SSH** into the instance unless you create a new key or replace it manually.
* Never upload it to public repositories (GitHub, etc.) â€” itâ€™s sensitive.
* Permissions should be **restricted**:

```bash
chmod 400 MyKeyPair.pem
```

* This prevents other users from reading the file.

---

## 3ï¸âƒ£ How Key Pair Works with EC2 ğŸ”—

1. When launching an EC2 instance, you **choose a key pair**.
2. AWS automatically installs the **public key** in the EC2 instance (in `~/.ssh/authorized_keys`).
3. You use the **private key `.pem`** to connect via SSH:

```bash
ssh -i MyKeyPair.pem ec2-user@<Public-IP>
```

4. AWS verifies your private key matches the public key â€” if yes, you gain access. âœ…

---

## 4ï¸âƒ£ Creating a Key Pair in AWS ğŸ› ï¸

### **Using Console**

1. Go to **EC2 â†’ Key Pairs â†’ Create Key Pair**
2. Enter a **name** for the key (e.g., `MyKeyPair`)
3. Choose **RSA or ED25519** (RSA is default, ED25519 is more secure)
4. Click **Create** â†’ AWS will download the `.pem` file automatically
5. Store it securely (never lose it)

### **Using AWS CLI**

```bash
aws ec2 create-key-pair --key-name MyKeyPair --query 'KeyMaterial' --output text > MyKeyPair.pem
chmod 400 MyKeyPair.pem
```

---

## 5ï¸âƒ£ Best Practices for Key Pairs ğŸ”

* ğŸ”’ **Do not share** your `.pem` file.
* ğŸ“¦ **Backup** your `.pem` securely (encrypted vault or password manager).
* âŒ Do not commit it to Git or upload it to cloud storage publicly.
* âš¡ Use **different key pairs per environment** (dev, test, prod).
* ğŸ”„ Rotate key pairs if compromised: create a new key pair, update EC2 instances, revoke old key.
* ğŸ›¡ï¸ Prefer **SSH agent forwarding** or IAM roles for automated access instead of distributing private keys.

---

## 6ï¸âƒ£ Troubleshooting SSH with `.pem` âš¡

* **Error: Permission denied (publickey)** â†’ likely wrong username or `.pem` permissions.
* **Cannot connect** â†’ instance not using the same key, or key lost.
* **Solution** â†’ replace key by stopping instance, mounting the volume on a temporary instance, and updating `authorized_keys`.

---

## 7ï¸âƒ£ Analogy ğŸ 

* **EC2 instance** = your house
* **Public key** = the lock installed on the door
* **Private key `.pem`** = your key that opens the door
* âœ… Only someone with the correct key can enter; even if someone sees the lock, they canâ€™t open it without the key.

---

## âœ… Summary

* AWS **Key Pair** = Public + Private key set for secure SSH access.
* **`.pem` file** = your private key; **never share**, **store securely**, **use with `ssh -i`**.
* Key pairs protect your EC2 instance, and AWS does **not allow password access** for Linux Free-Tier instances by default.

---