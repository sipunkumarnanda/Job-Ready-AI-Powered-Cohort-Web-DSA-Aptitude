


# ğŸ› ï¸ Update Operators in MongoDB / Mongoose (In-Depth Notes)

Used in **MongoDB** and **Mongoose**, **update operators** allow you to **modify specific fields of a document safely and efficiently**.

---

## ğŸ“Œ 1. What Is an Update Operator?

### âœ… Definition

An **update operator** is a **special keyword (starts with `$`)** used inside update queries to **change part of a document instead of replacing the whole document**.

ğŸ“Œ Examples of update operators:

* `$set`
* `$unset`
* `$inc`
* `$push`
* `$pull`
* `$rename`
* `$addToSet`

---

## â“ 2. Why Update Operators Are Important

### âŒ Without Update Operators (Dangerous)

```js
db.users.updateOne(
  { _id: 1 },
  { age: 25 }
)
```

âš ï¸ This **replaces the entire document**, deleting name, email, etc.

---

### âœ… With Update Operators (Safe)

```js
db.users.updateOne(
  { _id: 1 },
  { $set: { age: 25 } }
)
```

âœ”ï¸ Only `age` is updated
âœ”ï¸ Other fields remain unchanged

---

## ğŸ¯ 3. When to Use Update Operators

Use update operators when you want to:

* âœ… Modify **one or more fields**
* âœ… Increment/decrement numbers
* âœ… Add/remove array elements
* âœ… Update nested fields
* âœ… Avoid data loss
* âœ… Perform **atomic operations**

---

## ğŸ“ 4. Where Update Operators Are Used

Update operators are used in:

### MongoDB Methods

* `updateOne()`
* `updateMany()`
* `findOneAndUpdate()`
* `update()` (deprecated)

### Mongoose Methods

* `Model.updateOne()`
* `Model.updateMany()`
* `Model.findByIdAndUpdate()`
* `Model.findOneAndUpdate()`

---

## ğŸ§± 5. Database Schema (Used for All Examples)

### MongoDB / Mongoose Schema

```js
User {
  _id: ObjectId,
  name: String,
  age: Number,
  email: String,
  city: String,
  isActive: Boolean,
  salary: Number,
  skills: [String],
  address: {
    street: String,
    pincode: Number
  }
}
```

---

# ğŸ”‘ 6. Common Update Operators (With Examples)

---

## ğŸŸ¢ `$set` â€” Update or Add Fields

### ğŸ“Œ Purpose

* Updates existing fields
* Adds field if it does not exist

### ğŸ§ª Example

```js
db.users.updateOne(
  { name: "Amit" },
  { $set: { age: 30, city: "Delhi" } }
)
```

âœ”ï¸ Updates only `age` and `city`
âœ”ï¸ Other fields remain unchanged

---

## ğŸ”´ `$unset` â€” Remove a Field

### ğŸ“Œ Purpose

* Deletes a field from the document

### ğŸ§ª Example

```js
db.users.updateOne(
  { name: "Amit" },
  { $unset: { email: "" } }
)
```

âœ”ï¸ `email` field is removed completely

---

## ğŸ”µ `$inc` â€” Increment / Decrement Numbers

### ğŸ“Œ Purpose

* Increase or decrease numeric values

### ğŸ§ª Example

```js
db.users.updateOne(
  { name: "Amit" },
  { $inc: { salary: 5000 } }
)
```

â• Adds 5000 to salary

```js
{ $inc: { salary: -2000 } }
```

â– Decreases salary by 2000

---

## ğŸŸ¡ `$rename` â€” Rename a Field

### ğŸ“Œ Purpose

* Changes field name

### ğŸ§ª Example

```js
db.users.updateOne(
  { name: "Amit" },
  { $rename: { city: "location" } }
)
```

âœ”ï¸ `city` becomes `location`

---

## ğŸŸ£ `$push` â€” Add Element to Array

### ğŸ“Œ Purpose

* Adds a value to an array

### ğŸ§ª Example

```js
db.users.updateOne(
  { name: "Amit" },
  { $push: { skills: "Node.js" } }
)
```

ğŸ“¦ `skills: ["Java", "Node.js"]`

---

## ğŸ”¶ `$addToSet` â€” Add Unique Value to Array

### ğŸ“Œ Purpose

* Adds element **only if it does not exist**

### ğŸ§ª Example

```js
db.users.updateOne(
  { name: "Amit" },
  { $addToSet: { skills: "Java" } }
)
```

âœ”ï¸ Prevents duplicates

---

## ğŸ”» `$pull` â€” Remove Element from Array

### ğŸ“Œ Purpose

* Removes matching value from array

### ğŸ§ª Example

```js
db.users.updateOne(
  { name: "Amit" },
  { $pull: { skills: "Java" } }
)
```

âŒ Removes `"Java"` from skills

---

## ğŸ§© 7. Updating Nested Fields

### ğŸ“Œ Dot Notation

```js
db.users.updateOne(
  { name: "Amit" },
  { $set: { "address.pincode": 110001 } }
)
```

âœ”ï¸ Updates nested object field

---

## ğŸ” 8. Update One vs Update Many

### ğŸ§ª Update One

```js
db.users.updateOne(
  { city: "Delhi" },
  { $set: { isActive: true } }
)
```

âœ”ï¸ Updates first matched document

---

### ğŸ§ª Update Many

```js
db.users.updateMany(
  { city: "Delhi" },
  { $set: { isActive: true } }
)
```

âœ”ï¸ Updates all matching documents

---

## ğŸš€ 9. Update Operators in Mongoose

### ğŸ§ª Example

```js
User.updateOne(
  { name: "Amit" },
  { $set: { age: 28 } }
)
```

### Find & Update

```js
User.findByIdAndUpdate(
  id,
  { $inc: { salary: 1000 } },
  { new: true }
)
```

âœ”ï¸ `{ new: true }` returns updated document

---

## âš ï¸ 10. Important Rules & Best Practices

âœ… Always use update operators
âŒ Never update without `$set` accidentally
âœ… Use `$inc` for counters
âœ… Use `$addToSet` to avoid duplicates
âœ… Use `updateOne()` / `updateMany()` instead of deprecated `update()`

---

## ğŸ“ 11. Summary (Quick Revision)

| Operator    | Use                        |
| ----------- | -------------------------- |
| `$set`      | Add / update field         |
| `$unset`    | Remove field               |
| `$inc`      | Increase / decrease number |
| `$push`     | Add to array               |
| `$pull`     | Remove from array          |
| `$addToSet` | Add unique value           |
| `$rename`   | Rename field               |

---
