


# ğŸ”„ Mongoose Update Methods Comparison

### `updateOne()` vs `findOneAndUpdate()` vs `findByIdAndUpdate()`

All three methods are provided by **Mongoose** to update documents stored in **MongoDB**, but they serve **different purposes**.

---

## ğŸ§  1. Big Picture Overview (Before Details)

| Method                | Updates | Returns Document? | Filter Type |
| --------------------- | ------- | ----------------- | ----------- |
| `updateOne()`         | One     | âŒ No              | Any field   |
| `findOneAndUpdate()`  | One     | âœ… Yes             | Any field   |
| `findByIdAndUpdate()` | One     | âœ… Yes             | `_id` only  |

---

# ğŸ› ï¸ 2. `updateOne()` â€” Simple Update, No Return

## ğŸ“Œ What Is `updateOne()`?

`updateOne()` updates **only one matching document**, but **does NOT return the document**.

---

## ğŸ¯ When to Use `updateOne()`

Use when:

* âœ… You **only care about updating**
* âŒ You **do NOT need the updated document**
* âœ… Updating using unique fields (email, username)
* âœ… Performance matters (lighter than find & return)

---

## ğŸ§± Schema for Examples

```js
User {
  name: String,
  age: Number,
  email: String
}
```

---

## ğŸ§ª Example: Using `updateOne()`

```js
User.updateOne(
  { email: "amit@gmail.com" },
  { $set: { age: 30 } }
);
```

### âœ… What Happens?

* One document updated
* âŒ No document returned
* âœ”ï¸ Returns only update result info

---

## ğŸ“¦ What `updateOne()` Returns

```js
{
  acknowledged: true,
  matchedCount: 1,
  modifiedCount: 1
}
```

---

# ğŸ” 3. `findOneAndUpdate()` â€” Update + Return (Any Field)

## ğŸ“Œ What Is `findOneAndUpdate()`?

`findOneAndUpdate()`:

* Finds **one document using any condition**
* Updates it
* Returns **old or updated document**

---

## ğŸ¯ When to Use `findOneAndUpdate()`

Use when:

* âœ… You need the **updated document immediately**
* âœ… Updating using fields like email, username
* âœ… You want **atomic find + update**
* âŒ You donâ€™t want to fetch separately

---

## ğŸ§± Schema for Examples

```js
User {
  name: String,
  age: Number,
  email: String,
  isActive: Boolean
}
```

---

## ğŸ§ª Example: Using `findOneAndUpdate()`

```js
User.findOneAndUpdate(
  { email: "amit@gmail.com" },
  { $set: { isActive: true } },
  { new: true }
);
```

### âœ… What Happens?

* Finds user by email
* Updates `isActive`
* Returns **updated document** ğŸŸ¢

---

## ğŸ“¦ What `findOneAndUpdate()` Returns

| Option                 | Returned         |
| ---------------------- | ---------------- |
| `new: false` (default) | Old document     |
| `new: true`            | Updated document |
| No match               | `null`           |

---

# ğŸ†” 4. `findByIdAndUpdate()` â€” Best When `_id` Is Known

## ğŸ“Œ What Is `findByIdAndUpdate()`?

A **shortcut method** that:

* Finds document by `_id`
* Updates it
* Returns **old or updated document**

Internally:

```js
findOneAndUpdate({ _id: id })
```

---

## ğŸ¯ When to Use `findByIdAndUpdate()`

Use when:

* âœ… You already have `_id`
* âœ… Common REST APIs (`PUT /users/:id`)
* âœ… Cleaner & more readable code
* âœ… You want updated document

---

## ğŸ§± Schema for Examples

```js
User {
  name: String,
  age: Number,
  city: String
}
```

---

## ğŸ§ª Example: Using `findByIdAndUpdate()`

```js
User.findByIdAndUpdate(
  "64a9f8c2e123456789abcd01",
  { $set: { city: "Delhi" } },
  { new: true }
);
```

### âœ… What Happens?

* Finds user by `_id`
* Updates city
* Returns **updated user**

---

## ğŸ“¦ What `findByIdAndUpdate()` Returns

| Case           | Return            |
| -------------- | ----------------- |
| `new: true`    | Updated document  |
| `new: false`   | Old document      |
| No document    | `null`            |
| `upsert: true` | Inserted document |

---

# ğŸ” 5. Side-by-Side Comparison (Most Important)

| Feature          | updateOne() | findOneAndUpdate() | findByIdAndUpdate() |
| ---------------- | ----------- | ------------------ | ------------------- |
| Updates how many | One         | One                | One                 |
| Returns document | âŒ No        | âœ… Yes              | âœ… Yes               |
| Filter by `_id`  | âŒ           | âŒ                  | âœ…                   |
| Uses any field   | âœ…           | âœ…                  | âŒ                   |
| Best for APIs    | âŒ           | âœ…                  | âœ…âœ…                  |
| Simplicity       | â­â­â­         | â­â­â­â­               | â­â­â­â­â­               |

---

# ğŸ§­ 6. When to Use What? (Decision Guide)

### ğŸ”¹ Use `updateOne()` when:

* âœ”ï¸ You just want to update
* âœ”ï¸ You donâ€™t need the document back
* âœ”ï¸ Performance is critical

---

### ğŸ”¹ Use `findOneAndUpdate()` when:

* âœ”ï¸ You need updated data immediately
* âœ”ï¸ You donâ€™t have `_id`
* âœ”ï¸ You are updating by email / username

---

### ğŸ”¹ Use `findByIdAndUpdate()` when:

* âœ”ï¸ You have `_id`
* âœ”ï¸ Writing REST APIs
* âœ”ï¸ Want clean, readable code
* âœ”ï¸ Most common real-world use âœ…

---

# âš ï¸ 7. Best Practices (Very Important)

âœ… Always use update operators (`$set`, `$inc`)
âœ… Use `{ new: true }` when returning updated data
âœ… Use `{ runValidators: true }` for safe updates
âŒ Donâ€™t use these for bulk updates (`updateMany()` instead)

---

# ğŸ“ 8. Exam / Interview Key Points

* `updateOne()` â†’ update only, no return
* `findOneAndUpdate()` â†’ update + return (any field)
* `findByIdAndUpdate()` â†’ update + return by `_id`
* All update **only one document**
* `new: true` is critical in Mongoose

---