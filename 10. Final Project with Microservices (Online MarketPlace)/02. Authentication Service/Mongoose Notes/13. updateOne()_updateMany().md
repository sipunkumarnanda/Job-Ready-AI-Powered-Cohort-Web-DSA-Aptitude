



# ğŸ› ï¸ `updateOne()` and `updateMany()` in MongoDB / Mongoose

`updateOne()` and `updateMany()` are **modern, recommended update methods** in **MongoDB** and **Mongoose**.
They were introduced to **replace the deprecated `update()` method** with **clearer and safer APIs**.

---

## ğŸ“Œ 1. What Is `updateOne()`?

### âœ… Definition

`updateOne()` updates **only the first document** that matches the given query filter.

ğŸ“Œ Even if multiple documents match, **only one document is updated**.

---

## ğŸ“Œ 2. What Is `updateMany()`?

### âœ… Definition

`updateMany()` updates **all documents** that match the given query filter.

ğŸ“Œ It is explicitly designed for **bulk updates**.

---

## â“ 3. When to Use `updateOne()` vs `updateMany()`

### âœ… Use `updateOne()` When:

* You want to update **exactly one document**
* Updating by:

  * `_id`
  * unique fields (email, username)
* Avoiding accidental multiple updates

### âœ… Use `updateMany()` When:

* You want to update **multiple documents**
* Applying changes to:

  * all users in a city
  * all inactive accounts
  * bulk status updates

---

## ğŸ“ 4. Where Are They Used?

### MongoDB Shell

```js
db.collection.updateOne()
db.collection.updateMany()
```

### Mongoose

```js
Model.updateOne()
Model.updateMany()
```

ğŸ“Œ These methods are **recommended in all modern MongoDB & Mongoose applications**.

---

## ğŸ§± 5. Syntax

### `updateOne()` Syntax

```js
db.collection.updateOne(
  <filter>,
  <update>,
  <options>
)
```

### `updateMany()` Syntax

```js
db.collection.updateMany(
  <filter>,
  <update>,
  <options>
)
```

---

## ğŸ§© 6. Parameters Explained (Both Methods)

### ğŸ” Filter

* Selects documents to update
* Same as `find()` condition

### ğŸ› ï¸ Update

* Uses **update operators** (`$set`, `$inc`, `$push`, etc.)
* Prevents full document replacement

### âš™ï¸ Options

| Option   | Description                       |
| -------- | --------------------------------- |
| `upsert` | Insert document if no match found |

---

# ğŸ§ª 7. Examples of `updateOne()` (Schema Before Each Example)

---

## Example 1ï¸âƒ£: Update a Single Field

### ğŸ“„ Database Schema

```js
User {
  _id: ObjectId,
  name: String,
  age: Number,
  city: String
}
```

### ğŸ§ª MongoDB Query

```js
db.users.updateOne(
  { name: "Amit" },
  { $set: { age: 30 } }
)
```

### âœ… Explanation

* Updates **only one matching document**
* Safe even if multiple users are named "Amit"

---

## Example 2ï¸âƒ£: Increment a Numeric Value

### ğŸ“„ Database Schema

```js
Account {
  accountNo: Number,
  balance: Number
}
```

### ğŸ§ª Query

```js
db.accounts.updateOne(
  { accountNo: 101 },
  { $inc: { balance: 500 } }
)
```

### âœ… Explanation

* Increments balance atomically
* Prevents race conditions

---

## Example 3ï¸âƒ£: Upsert Using `updateOne()`

### ğŸ“„ Database Schema

```js
Product {
  item: String,
  price: Number
}
```

### ğŸ§ª Query

```js
db.products.updateOne(
  { item: "Pen" },
  { $set: { price: 10 } },
  { upsert: true }
)
```

### âœ… Explanation

* If product exists â†’ update
* If not â†’ insert new product

---

# ğŸ§ª 8. Examples of `updateMany()` (Schema Before Each Example)

---

## Example 4ï¸âƒ£: Update Multiple Documents

### ğŸ“„ Database Schema

```js
User {
  name: String,
  city: String,
  isActive: Boolean
}
```

### ğŸ§ª MongoDB Query

```js
db.users.updateMany(
  { city: "Delhi" },
  { $set: { isActive: true } }
)
```

### âœ… Explanation

* Updates **all users in Delhi**
* Clear intent compared to old `update()` + `multi:true`

---

## Example 5ï¸âƒ£: Increment Field for Multiple Documents

### ğŸ“„ Database Schema

```js
Employee {
  department: String,
  salary: Number
}
```

### ğŸ§ª Query

```js
db.employees.updateMany(
  { department: "HR" },
  { $inc: { salary: 2000 } }
)
```

### âœ… Explanation

* Increases salary of all HR employees
* Efficient bulk update

---

## Example 6ï¸âƒ£: Remove a Field from Multiple Documents

### ğŸ“„ Database Schema

```js
User {
  name: String,
  tempFlag: Boolean
}
```

### ğŸ§ª Query

```js
db.users.updateMany(
  { tempFlag: true },
  { $unset: { tempFlag: "" } }
)
```

### âœ… Explanation

* Removes `tempFlag` from all matched documents

---

## ğŸ“¦ 9. What Do `updateOne()` and `updateMany()` Return?

### ğŸ“¤ Return Type

Both return an **UpdateResult object**

### ğŸ§¾ Sample Return

```js
{
  acknowledged: true,
  matchedCount: 3,
  modifiedCount: 3,
  upsertedId: null
}
```

---

### ğŸ“Š Return Fields Explained

| Field           | Meaning                               |
| --------------- | ------------------------------------- |
| `acknowledged`  | Operation acknowledged by MongoDB     |
| `matchedCount`  | Documents matched                     |
| `modifiedCount` | Documents actually modified           |
| `upsertedId`    | Inserted document ID (if upsert used) |

---

## ğŸš€ 10. `updateOne()` & `updateMany()` in Mongoose

### Mongoose `updateOne()`

```js
User.updateOne(
  { name: "Amit" },
  { $set: { age: 28 } }
)
```

### Mongoose `updateMany()`

```js
User.updateMany(
  { city: "Delhi" },
  { $set: { verified: true } }
)
```

ğŸ“Œ Mongoose **does not return updated documents**, only result info.

---

## âš ï¸ 11. Important Notes & Best Practices

âœ… Always use update operators (`$set`, `$inc`)
âœ… Use `updateOne()` for unique records
âœ… Use `updateMany()` for bulk updates
âŒ Do not expect updated document as return
ğŸ“Œ Use `findOneAndUpdate()` if updated document is required

---

## ğŸ“ 12. Quick Comparison Table

| Feature          | updateOne()           | updateMany()       |
| ---------------- | --------------------- | ------------------ |
| Updates          | One document          | Multiple documents |
| Safer            | âœ… Yes                 | âœ… Yes              |
| Bulk update      | âŒ No                  | âœ… Yes              |
| Replacement risk | âŒ No (with operators) | âŒ No               |
| Deprecated       | âŒ No                  | âŒ No               |

---

## ğŸ§  13. Key Exam & Interview Points

* `updateOne()` updates **only the first matched document**
* `updateMany()` updates **all matched documents**
* Both replaced deprecated `update()`
* Both return **UpdateResult**
* Use update operators to avoid data loss

---