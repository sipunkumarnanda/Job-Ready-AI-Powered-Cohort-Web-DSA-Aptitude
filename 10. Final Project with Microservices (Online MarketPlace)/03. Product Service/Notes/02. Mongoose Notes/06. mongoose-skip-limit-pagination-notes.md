


# ğŸ“˜ Pagination in Mongoose: `skip()` & `limit()` â€“ In-Depth Notes

---

## ğŸ“Œ Code in Context (At One Place)

```js
const products = await productModel
  .find(filter)
  .skip(Number(skip))
  .limit(Math.min(Number(limit), 20));
```

---

## ğŸ”¹ What Are `skip()` and `limit()`?

In Mongoose (MongoDB):

* **`skip(n)`** â†’ ignores the first `n` documents
* **`limit(n)`** â†’ returns only `n` documents

Together, they are used for **pagination**.

---

## ğŸ§  Why Pagination Is Needed (VERY IMPORTANT)

Imagine your database has **1,00,000 products**.

âŒ Without pagination:

* Huge response size
* Slow API
* High memory usage
* Bad user experience

âœ… With pagination:

* Load data in small chunks
* Faster responses
* Better performance

---

## ğŸ”¹ What Does `.find(filter)` Do?

```js
.find(filter)
```

* Fetches documents that match `filter`
* Example filter:

```js
{ "price.amount": { $gte: 500 } }
```

Pagination works **after filtering**.

---

# ğŸ§© Understanding `limit()`

## ğŸ”¹ What is `limit()`?

```js
.limit(10)
```

â¡ Returns **only 10 documents**

---

## ğŸ”¹ Example

```js
productModel.find().limit(5);
```

ğŸ“¤ Output:

* First 5 products from database

---

## ğŸ”¹ Why `limit()` Is Important

âœ” Prevents large payloads
âœ” Improves response time
âœ” Protects server from abuse

---

## ğŸ”¹ Protecting API with Max Limit

```js
.limit(Math.min(Number(limit), 20))
```

### What this means:

* If user sends `limit=1000`
* Server still returns only `20`

ğŸ” This is an **API protection technique**

---

# ğŸ§© Understanding `skip()`

## ğŸ”¹ What is `skip()`?

```js
.skip(10)
```

â¡ Skips the first 10 documents
â¡ Starts returning from the 11th document

---

## ğŸ”¹ Example

```js
productModel.find().skip(10).limit(5);
```

ğŸ“¤ Output:

* Products 11 â†’ 15

---

## ğŸ§  Mental Model (Very Easy)

Think of a list:

```
1  2  3  4  5  6  7  8  9  10  11  12
```

* `skip(5)` â†’ ignore `1â€“5`
* `limit(3)` â†’ return `6â€“8`

---

# ğŸ”¹ Pagination Example (Real API)

### Request

```
/products?skip=20&limit=10
```

### Meaning

* Skip first 20 products
* Return next 10 products

â¡ Page 3 (assuming 10 per page)

---

## ğŸ”¹ Common Pagination Formula

```js
skip = (page - 1) * limit
```

### Example

```js
page = 2
limit = 10
skip = 10
```

---

# ğŸ§  Full Pagination Example (Controller)

```js
const page = Number(req.query.page) || 1;
const limit = 10;

const products = await productModel
  .find(filter)
  .skip((page - 1) * limit)
  .limit(limit);
```

---

# âš ï¸ Important Notes About `skip()`

## ğŸ”¸ Performance Concern

* `skip()` becomes **slow on large datasets**
* MongoDB must scan skipped documents

---

## ğŸ”¸ When NOT to Use `skip()`

âŒ Infinite scrolling with huge data
âŒ Millions of records

---

## âœ… Better Alternative (Advanced)

### Cursor-based Pagination

```js
.find({ _id: { $gt: lastId } })
.limit(10);
```

âœ” Faster
âœ” Scales better

---

# ğŸ§  When to Use `skip()` & `limit()`

### âœ… Use When:

* Small to medium datasets
* Admin dashboards
* Product listings
* Search results

### âŒ Avoid When:

* Huge datasets
* Real-time feeds
* Infinite scrolling at scale

---

# ğŸ“Š Summary Table

| Method     | Purpose                  |
| ---------- | ------------------------ |
| `find()`   | Fetch matching documents |
| `skip(n)`  | Skip first `n` documents |
| `limit(n)` | Return max `n` documents |

---

# ğŸ¯ Interview Explanation (IMPRESSIVE)

**Q:** What are `skip()` and `limit()` in Mongoose?

**Answer:**

> â€œ`skip()` is used to ignore a specified number of documents, while `limit()` restricts the number of documents returned. Together, they are commonly used to implement pagination in MongoDB queries.â€

### Bonus Line (Very Impressive):

> â€œFor large datasets, `skip()` can be inefficient, so cursor-based pagination is often preferred.â€

---

# ğŸ§  Key Takeaways (Revision)

âœ… Pagination improves performance
âœ… `limit()` controls response size
âœ… `skip()` controls offset
âœ… Always cap maximum limit
âœ… Use cursor pagination for large data

---