


## ğŸ“¦ Mongoose Product Schema â€“ In-Depth Notes & Explanation

---

### ğŸ§© Complete Code (As-Is)

```js
const mongoose = require("mongoose");

const productSchema = new mongoose.Schema({
  title: {
    type: String,
    required: true,
  },
  description: {
    type: String,
    required: true,
  },
  price: {
    amount: {
      type: Number,
      required: true,
    },
    currency: {
      type: String,
      enum: ["USD", "INR"],
      default: "INR",
    },
  },
  seller: {
    type: mongoose.Schema.ObjectId,
    required: true,
  },
  images: [
    {
      url: String,
      thumbnail: String,
      id: String,
    },
  ]
});

productSchema.index({ title: 'text', description: 'text' })

const productModel = mongoose.model("products", productSchema);

module.exports = productModel;
```

---

## ğŸ§  Overview: What This File Does

This file defines a **Product data model** using **Mongoose**, which:

* Describes how product data is stored in MongoDB
* Enforces validation rules at the database level
* Adds indexing for search performance
* Exports a reusable model for CRUD operations

---

## 1ï¸âƒ£ Importing Mongoose ğŸ§¬

```js
const mongoose = require("mongoose");
```

### ğŸ” Why this is needed:

* Mongoose is an ODM (**Object Data Modeling**) library
* It provides:

  * Schema definitions
  * Validation
  * Middleware (hooks)
  * Model-based database interaction

ğŸ“Œ Without this, MongoDB collections would be schema-less and unstructured.

---

## 2ï¸âƒ£ Creating the Product Schema ğŸ§±

```js
const productSchema = new mongoose.Schema({ ... })
```

### ğŸ” What is a Schema?

A **Schema**:

* Defines the structure of documents in a collection
* Controls data types
* Adds validation rules
* Improves data consistency

---

## 3ï¸âƒ£ `title` Field ğŸ·ï¸

```js
title: {
  type: String,
  required: true,
},
```

### ğŸ” Explanation:

* `type: String` â†’ Only text values allowed
* `required: true` â†’ Mandatory field

ğŸ“Œ Use case:

* Product name (e.g., "iPhone 15")

âŒ Prevents:

* Missing product names
* Invalid data types

---

## 4ï¸âƒ£ `description` Field ğŸ“

```js
description: {
  type: String,
  required: true,
},
```

### ğŸ” Explanation:

* Detailed information about the product
* Required to ensure meaningful listings

ğŸ“Œ Works well with **text search indexing** (explained later)

---

## 5ï¸âƒ£ `price` Object ğŸ’° (Nested Schema)

```js
price: {
  amount: {
    type: Number,
    required: true,
  },
  currency: {
    type: String,
    enum: ["USD", "INR"],
    default: "INR",
  },
},
```

### ğŸ” Why nested object?

Keeps price-related fields **grouped logically**

---

### ğŸŸ¢ `price.amount`

* Must be a number
* Required field

ğŸ“Œ Example:

```js
price: { amount: 999 }
```

---

### ğŸŸ£ `price.currency`

* Limited to `"USD"` or `"INR"`
* Defaults to `"INR"` if not provided

ğŸ” `enum` ensures:

* No invalid currencies
* Controlled values

ğŸ“Œ Example:

```js
price: { amount: 999, currency: "USD" }
```

---

## 6ï¸âƒ£ `seller` Field ğŸ‘¤

```js
seller: {
  type: mongoose.Schema.ObjectId,
  required: true,
},
```

### ğŸ” Explanation:

* Stores MongoDB ObjectId
* Refers to the **user who created the product**

ğŸ“Œ Typically linked to a User model:

```js
seller: user._id
```

ğŸ” Enforces:

* Ownership
* Relationship between collections

---

## 7ï¸âƒ£ `images` Array ğŸ–¼ï¸

```js
images: [
  {
    url: String,
    thumbnail: String,
    id: String,
  },
]
```

### ğŸ” Explanation:

* An array of image objects
* Each image can store:

  * `url` â†’ full image
  * `thumbnail` â†’ smaller preview
  * `id` â†’ cloud storage ID (e.g., Cloudinary)

ğŸ“Œ Allows multiple images per product

---

## 8ï¸âƒ£ Text Index for Search ğŸ”âš¡

```js
productSchema.index({ title: 'text', description: 'text' })
```

### ğŸ” What this does:

* Creates a **text index** on `title` and `description`
* Enables full-text search

ğŸ“Œ Example query:

```js
Product.find({ $text: { $search: "laptop" } })
```

### ğŸš€ Benefits:

* Faster search queries
* Ranking by relevance
* Better UX for product search

---

## 9ï¸âƒ£ Creating the Model ğŸ—ï¸

```js
const productModel = mongoose.model("products", productSchema);
```

### ğŸ” Explanation:

* Converts schema into a usable model
* `"products"` â†’ Collection name in MongoDB
* Provides methods like:

  * `.create()`
  * `.find()`
  * `.findById()`
  * `.updateOne()`

ğŸ“Œ MongoDB will create the collection automatically if it doesnâ€™t exist

---

## ğŸ”Ÿ Exporting the Model ğŸ“¤

```js
module.exports = productModel;
```

### ğŸ” Why export?

* Allows usage across the app:

  * Controllers
  * Services
  * Routes

ğŸ“Œ Example:

```js
const Product = require("../models/product.model");
```

---

## âœ… Summary Table ğŸ“Š

| Field            | Purpose             |
| ---------------- | ------------------- |
| `title`          | Product name        |
| `description`    | Product details     |
| `price.amount`   | Numeric price       |
| `price.currency` | Controlled currency |
| `seller`         | Owner reference     |
| `images`         | Product images      |
| `text index`     | Fast search         |

---

## ğŸš€ Best Practices Youâ€™re Already Using

* âœ” Schema validation
* âœ” Nested objects
* âœ” Enum restrictions
* âœ” Text indexing
* âœ” Clean model export

---