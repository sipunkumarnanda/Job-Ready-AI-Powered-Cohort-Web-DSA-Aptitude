


# ğŸ” Get Product By ID API â€“ Explanation Notes

---

## ğŸ“Œ Complete Code (At One Place)

```js
async function getProductById(req, res) {
  const { id } = req.params;

  if (!mongoose.Types.ObjectId.isValid(id)) {
    return res.status(400).json({
      message: "Invalid product id",
    });
  }

  try {
    const product = await productModel.findById(id);

    if (!product) {
      return res.status(404).json({
        message: "product not found",
      });
    }

    return res.status(200).json({
      message: "product fetch successfully",
      data: product,
    });
  } catch (error) {
    console.error("Error occured in getProductById ", error);
    return res.status(500).json({
      message: "Internal server error",
    });
  }
}
```

---

## ğŸ§  Module-wise Explanation

---

## 1ï¸âƒ£ Async Function Definition ğŸš€

```js
async function getProductById(req, res)
```

* Express **controller function**
* Marked `async` to handle MongoDB operations
* Allows clean `await` usage

---

## 2ï¸âƒ£ Extracting Product ID from URL ğŸ†”

```js
const { id } = req.params;
```

* Reads product ID from route parameter
* Example route:

  ```
  GET /products/:id
  ```

---

## 3ï¸âƒ£ Validating MongoDB ObjectId âœ…ğŸ›‘

```js
if (!mongoose.Types.ObjectId.isValid(id)) {
  return res.status(400).json({
    message: "Invalid product id",
  });
}
```

### Why this is important:

* Prevents MongoDB cast errors
* Stops unnecessary DB queries
* Improves API performance & safety

ğŸ“Œ Returns:

* `400 Bad Request` â†’ invalid ID format

---

## 4ï¸âƒ£ Fetching Product from Database ğŸ—„ï¸

```js
const product = await productModel.findById(id);
```

* Uses Mongooseâ€™s `findById`
* Searches product by `_id`
* Returns:

  * product document OR
  * `null` if not found

---

## 5ï¸âƒ£ Handling Product Not Found âŒ

```js
if (!product) {
  return res.status(404).json({
    message: "product not found",
  });
}
```

* Handles valid but non-existing ID
* Returns:

  * `404 Not Found`

ğŸ“Œ Important distinction:

* Invalid ID â†’ `400`
* Valid but missing product â†’ `404`

---

## 6ï¸âƒ£ Success Response ğŸ“¤âœ…

```js
return res.status(200).json({
  message: "product fetch successfully",
  data: product,
});
```

* `200 OK` â†’ request successful
* Sends:

  * success message
  * product data

---

## 7ï¸âƒ£ Error Handling ğŸ›¡ï¸

```js
catch (error) {
  console.error("Error occured in getProductById ", error);
  return res.status(500).json({
    message: "Internal server error",
  });
}
```

* Catches unexpected errors
* Logs error for debugging
* Sends generic response to client

---

## ğŸ¯ Key Takeaways (Interview Ready)

âœ… ObjectId validation before DB call
âœ… Proper HTTP status codes (`400`, `404`, `200`, `500`)
âœ… Clean error handling
âœ… Efficient database querying
âœ… Secure and production-ready API

---