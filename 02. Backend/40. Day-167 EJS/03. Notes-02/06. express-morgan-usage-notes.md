
# üß© How to Install and Use Morgan in Node.js/Express üö¶

Morgan is a **HTTP request logger middleware** for Express. Here‚Äôs a complete guide on installation, implementation, and usage of its formats.

---

## 1Ô∏è‚É£ **Installing Morgan**

Open your terminal and run:

```bash
npm install morgan
```

* This installs Morgan as a dependency in your project.
* Optionally, save it as a dev dependency for development-only use:

```bash
npm install --save-dev morgan
```

---

## 2Ô∏è‚É£ **Implementing Morgan in Express**

**Step 1: Import Express and Morgan**

```js
const express = require('express');
const morgan = require('morgan');

const app = express();
```

**Step 2: Use Morgan as middleware**

```js
// 'dev' is the format; explained below
app.use(morgan('dev'));
```

**Step 3: Define routes**

```js
app.get('/', (req, res) => {
  res.send('Hello, Morgan!');
});

app.listen(3000, () => console.log('Server running on http://localhost:3000'));
```

Now every HTTP request will be logged to the terminal.

---

## 3Ô∏è‚É£ **Morgan Predefined Formats**

Morgan comes with several **built-in formats**:

| Format     | Description                                                                               |
| ---------- | ----------------------------------------------------------------------------------------- |
| `dev`      | Concise output for development with **method, URL, status, response time** (colored)      |
| `tiny`     | Minimal output: **method, URL, status, response time**                                    |
| `combined` | Apache combined log format: **IP, user, date, method, URL, status, referrer, user-agent** |
| `common`   | Apache common log format: **IP, method, URL, status, content-length**                     |
| `short`    | Short format: **method, URL, status, content-length, response-time**                      |

---

### Example Usage

```js
// Dev format
app.use(morgan('dev'));

// Tiny format
// app.use(morgan('tiny'));

// Combined format
// app.use(morgan('combined'));
```

**Sample Output:**

**Dev**

```
GET / 200 5.123 ms - 13
```

**Tiny**

```
GET / 200 13 - 5.123 ms
```

**Combined**

```
::1 - - [21/Sep/2025:12:30:45 +0000] "GET / HTTP/1.1" 200 13 "-" "Mozilla/5.0..."
```

---

## 4Ô∏è‚É£ **Custom Format**

You can define your own logging format:

```js
app.use(morgan(':method :url :status :res[content-length] - :response-time ms'));
```

**Example Output:**

```
GET / 200 13 - 5.123 ms
```

* `:method` ‚Üí HTTP method (GET, POST)
* `:url` ‚Üí requested URL
* `:status` ‚Üí HTTP status code
* `:res[content-length]` ‚Üí response size in bytes
* `:response-time` ‚Üí time taken to respond

---

## 5Ô∏è‚É£ **Logging to a File**

By default, Morgan logs to the **console**, but you can log to a file:

```js
const fs = require('fs');
const path = require('path');

const accessLogStream = fs.createWriteStream(
  path.join(__dirname, 'access.log'), { flags: 'a' }
);

app.use(morgan('combined', { stream: accessLogStream }));
```

* All HTTP requests will now be saved in `access.log` in **combined format**.

---

## 6Ô∏è‚É£ **Integration Tips**

* **Use in development:** `dev` format ‚Üí colorful, concise logs.
* **Use in production:** `combined` format ‚Üí more detailed, can be saved to file.
* **Custom formats:** create one that matches your logging/monitoring requirements.
* Can integrate with **Winston** to save logs both in console and files.

---

## ‚úÖ **Summary**

1. Install: `npm install morgan`
2. Import and use middleware: `app.use(morgan('dev'))`
3. Predefined formats: `dev`, `tiny`, `combined`, `common`, `short`
4. Custom format: use tokens like `:method`, `:url`, `:status`, `:response-time`
5. File logging: pipe logs to a writable stream
6. Use `dev` for development, `combined` for production

---