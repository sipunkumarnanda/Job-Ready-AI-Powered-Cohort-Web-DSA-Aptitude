
# 🧩 EJS Scriptlets & Escaping Explained Clearly ✨

EJS (Embedded JavaScript) allows you to **mix JavaScript logic with HTML**. To do this safely and effectively, it provides **special tags called delimiters**. Let’s explore each one in-depth with examples and emojis for easy understanding.

---

## 1️⃣ **What is a Scriptlet? 📝**

**Definition:**
A **scriptlet** is a block of JavaScript code that runs inside an EJS template.

* **Delimiter:** `<% %>`
* **Purpose:** Execute **logic** like loops, conditionals, or variable declarations **without directly rendering output**.

**Example:**

```ejs
<ul>
  <% for(let i = 0; i < posts.length; i++) { %>
    <li><%= posts[i].title %></li>
  <% } %>
</ul>
```

✅ Here:

* `<% for(...) { %>` → runs the loop
* `<%= posts[i].title %>` → outputs title (escaped)
* `<% } %>` → closes the loop

**Tip:** Use scriptlets for **logic only**, not output.

---

## 2️⃣ **Escaping Output in EJS 🔒**

EJS provides two main ways to output data:

### a) `<%= %>` — Escaped Output ✅

* Automatically **escapes HTML special characters** (`<`, `>`, `&`)
* Safe for **untrusted data**

**Example:**

```ejs
<p>Username: <%= user.name %></p>
```

* If `user.name = "<Alice>"`
* Browser sees:

```html
<p>Username: &lt;Alice&gt;</p>
```

---

### b) `<%- %>` — Unescaped / Raw Output ⚠️

* Outputs **HTML as-is**, **no escaping**
* Use for **trusted content** like preformatted HTML

**Example:**

```ejs
<div><%- post.content %></div>
```

* If `post.content = "<strong>Bold!</strong>"`
* Browser renders bold text directly:

```html
<div><strong>Bold!</strong></div>
```

**Warning:** Using `<%- %>` with untrusted input can lead to **XSS attacks**. Always sanitize first.

---

## 3️⃣ **Comments in EJS `<%# %>` 💬**

* Used for **template comments**
* **Not rendered** in the final HTML

**Example:**

```ejs
<%# This is a comment %>
```

* Visible only in the template for developers.

---

## 4️⃣ **Literal Scriptlet `<%% %>` 🖋️**

* If you want to **show `<%` literally** in HTML:

```ejs
<p>Show template tag: <%%= user.name %></p>
```

* Output in browser:

```html
<p>Show template tag: <%= user.name %></p>
```

---

## 5️⃣ **Summary Table of EJS Tags 📊**

| EJS Tag  | Purpose                    | Output | Use Case                       |
| -------- | -------------------------- | ------ | ------------------------------ |
| `<% %>`  | Run JS logic (loops, ifs)  | None   | Logic only                     |
| `<%= %>` | Escaped output (HTML safe) | Yes    | Display user input safely      |
| `<%- %>` | Raw HTML output            | Yes    | Render HTML content directly   |
| `<%# %>` | Comment                    | None   | Developer notes                |
| `<%% %>` | Literal `<%`               | `<%`   | Show template syntax literally |

---

## 6️⃣ **Full Example Using All Tags 🖼️**

```ejs
<%# Comment: Welcome Section %>

<h1>Welcome, <%= user.name %>!</h1>

<div>
  <% posts.forEach(post => { %>
    <p><%- post.content %></p> <!-- raw HTML -->
  <% }) %>
</div>

<p>Show literal scriptlet: <%%= user.name %></p>
```

**Explanation:**

* `<%# %>` → comment, not rendered
* `<%= %>` → escaped username
* `<%- %>` → raw post content
* `<% %>` → logic (loop)
* `<%% %>` → literal `<%=` tag

---

## ✅ **Key Takeaways**

1. `<% %>` → logic only (loops, if/else, variable declarations) 🛠️
2. `<%= %>` → safe, escaped output for untrusted data 🔒
3. `<%- %>` → raw HTML output for trusted content ⚠️
4. `<%# %>` → comments for developers 💬
5. `<%% %>` → display literal EJS tags 🖋️

💡 **Tip:** Always escape untrusted user input using `<%= %>` to prevent XSS attacks. Use `<%- %>` only for safe HTML content.

---