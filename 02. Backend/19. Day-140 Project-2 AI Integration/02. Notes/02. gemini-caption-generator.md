
# 📘 Gemini API Integration for Generating Image Captions

This module integrates Google's **Gemini AI (Generative AI)** to generate *funny, dark-humor Hinglish* captions for images, using the Gemini 2.5 model.

---

## 🔧 1. Environment Setup

```js
import dotenv from 'dotenv'
dotenv.config()
```

* `dotenv` is used to load environment variables from a `.env` file.
* You must store your **Gemini API key** as an environment variable named:

  ```
  GEMINI_API_KEY=your_google_genai_api_key
  ```

---

## 🤖 2. Google Gemini AI Client Setup

```js
import { GoogleGenAI } from "@google/genai";

const ai = new GoogleGenAI({
  apiKey: process.env.GEMINI_API_KEY,
});
```

* Import the `GoogleGenAI` client from the official `@google/genai` npm package.
* The client is instantiated with your secure API key.
* This will allow you to make requests to Gemini models like `gemini-1.5-pro`, `gemini-2.5-flash`, etc.

---

## 🧠 3. generateCaption Function

### 🔹 Function Signature

```js
async function generateCaption(base64ImageFile)
```

* Accepts a base64-encoded image file string.
* Returns a **caption** generated by Gemini based on the image content.

---

### 🔹 Request Payload (Prompt Contents)

```js
const contents = [
  {
    inlineData: {
      mimeType: "image/jpeg",
      data: base64ImageFile,
    },
  },
  { text: "Caption this image." },
];
```

* The prompt uses **multi-modal content**:

  * `inlineData`: embeds image data directly (must be base64 format).
  * A textual instruction: *"Caption this image."*

---

### 🔹 Gemini API Request

```js
const response = await ai.models.generateContent({
  model: "gemini-2.5-flash",
  contents: contents,
  config: {
    systemInstruction: `
      Your task is to generate short and concise captions for images. Keep the captions to 2-3 lines maximum. caption should be dark humor funny. just adult vibe with a wink like dark comedy show. in hinglish dark comdedy. Always include relevant hashtags and a few emojis to match the vibe.`
  }
});
```

#### 📌 Breakdown:

| Field               | Explanation                                                              |
| ------------------- | ------------------------------------------------------------------------ |
| `model`             | `"gemini-2.5-flash"` – optimized for fast, multimodal content.           |
| `contents`          | Array of image + prompt objects                                          |
| `systemInstruction` | Sets the **personality and tone** of the AI — dark humor + Hinglish vibe |

---

### 🔹 Return the Result

```js
return response.text
```

* Returns only the AI-generated text (caption).
* This can be sent to frontend, stored, or used as needed.

---

## 📦 4. Exporting the Function

```js
export { generateCaption }
```

* Makes the function available for use in other parts of the project (e.g., `createPostController.js`).

---

## ✅ Example Output Use Case

```js
const caption = await generateCaption(base64Image)
console.log(caption)
```

Expected caption style:

> "Office gaya tha par chhutti mil gayi... ab HR bhi confused hai 😵‍💫
> \#JustAdultThings #OfficeChronicles 😂"

---

## 🛠️ NPM Dependencies Required

Make sure you have the following installed:

```bash
npm install dotenv @google/genai
```

---