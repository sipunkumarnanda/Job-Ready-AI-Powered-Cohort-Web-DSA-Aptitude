
# ğŸ“˜ **Deep Notes on Mongoose User Schema**

This document explains your `User` schema in **depth** so you can use it as a learning resource or documentation.

---

## 1ï¸âƒ£ Importing Mongoose

```js
import mongoose from "mongoose";
```

âœ¨ **Explanation:**

* âœ… Uses **ES Modules (ESM)** syntax (`import`) instead of CommonJS (`require`).
* âœ… `mongoose` is an ODM (**Object Data Modeling**) library for **MongoDB**.
* âœ… It allows:

  * Defining **schemas** (blueprints of data).
  * Adding **validation rules**.
  * Mapping those schemas to **MongoDB collections**.

---

## 2ï¸âƒ£ Defining the Schema

```js
const userSchema = new mongoose.Schema({
   ...
}, { timestamps: true })
```

âœ¨ **Explanation:**

* **`mongoose.Schema`** â†’ defines how documents look inside a MongoDB collection.
* It lets you:

  * Enforce **required fields**.
  * Define **data types**.
  * Add **default values**.
  * Create **indexes** (e.g., `unique`).
* The **second argument** `{ timestamps: true }`:

  * Automatically adds two fields:

    * ğŸ•’ `createdAt` â†’ when the document was created.
    * ğŸ”„ `updatedAt` â†’ when the document was last modified.
  * âœ… Useful for **auditing and tracking** user activity.

---

## 3ï¸âƒ£ Fields in the Schema

### âœ‰ï¸ a) Email

```js
email: {
  type: String,
  required: true,
  unique: true
}
```

* ğŸ“Œ **`type: String`** â†’ only strings allowed.
* ğŸ“Œ **`required: true`** â†’ cannot be missing.
* ğŸ“Œ **`unique: true`** â†’ MongoDB ensures no duplicate emails (creates a unique index).
* âš ï¸ **Important:** `unique` is **not a validator**â€”itâ€™s enforced by the database, not by Mongoose.

---

### ğŸ‘¤ b) Full Name (Nested Object)

```js
fullName: {
  firstName: {
    type: String,
    required: true
  },
  lastName: {
    type: String,
    required: true
  }
}
```

* ğŸ‘¨â€ğŸ’¼ **Why nested object?**

  * Instead of one string (`"John Doe"`), you split it into **first name** and **last name**.
* âœ… Benefits:

  * Easy to **query/filter** by `firstName` or `lastName`.
  * Clean structure for user profiles.
* Both fields are **required**, ensuring a complete name.

---

### ğŸ”‘ c) Password

```js
password: {
  type: String
}
```

* Stored as a **string**.
* Notice â†’ itâ€™s **not required**.

  * This is flexible for cases like:

    * Social logins (Google, GitHub, etc.) where password may not be stored.
    * Guest accounts.
* âš ï¸ **Security Best Practice:**

  * Never store raw passwords.
  * Always **hash passwords** using libraries like `bcrypt` before saving to DB.

---

## 4ï¸âƒ£ Schema Options

```js
{
  timestamps: true
}
```

* ğŸ•’ Automatically manages:

  * `createdAt`
  * `updatedAt`
* âœ… Saves effort: you donâ€™t need to manually track when users register or update profiles.

---

## 5ï¸âƒ£ Creating the Model

```js
const userModel = mongoose.model("user", userSchema)
```

âœ¨ **Explanation:**

* **`mongoose.model()`** compiles the schema into a **model**.
* A model acts like a **class constructor**:

  * You can use it to create, read, update, and delete (`CRUD`) documents.
* `"user"` â†’ MongoDB automatically **pluralizes** this into the `users` collection.
* `userSchema` â†’ the blueprint we defined.

---

## 6ï¸âƒ£ Exporting the Model

```js
export default userModel
```

âœ¨ **Explanation:**

* Exports the model for use across your app.
* Usage Example:

  ```js
  import User from "./models/User.js";

  const newUser = await User.create({
    email: "test@example.com",
    fullName: { firstName: "John", lastName: "Doe" },
    password: "hashedPassword123"
  });
  ```

---

## âœ… Key Takeaways

* ğŸ“œ **Schema** â†’ defines the structure of MongoDB documents.
* âœ‰ï¸ `email` â†’ required, unique, ensures no duplicate accounts.
* ğŸ‘¤ `fullName` â†’ nested object, enforces first + last name.
* ğŸ”‘ `password` â†’ optional, but **must be hashed**.
* ğŸ•’ **Timestamps** â†’ automatically track creation & updates.
* ğŸ— **Model** â†’ enables CRUD operations on the `users` collection.

---

## ğŸš€ Best Practices & Improvements (Optional)

1. **Email Validation**

   * Add regex to validate proper email format.

   ```js
   email: {
     type: String,
     required: true,
     unique: true,
     match: [/^\S+@\S+\.\S+$/, "Please enter a valid email"]
   }
   ```

2. **Password Hashing Middleware**

   * Use `pre('save')` hook to hash password before storing.
   * Example with `bcrypt`.

3. **Indexes**

   * Add compound indexes (e.g., if searching by `firstName + lastName`).

   ```js
   userSchema.index({ "fullName.firstName": 1, "fullName.lastName": 1 });
   ```

4. **Virtuals**

   * Add computed properties (e.g., `fullName` getter that returns `"John Doe"`).

---