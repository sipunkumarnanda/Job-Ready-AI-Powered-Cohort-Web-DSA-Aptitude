
# 📌 Notes on `jwt.sign()`

---

## 1️⃣ What is `jwt.sign()`?

* A method from the **jsonwebtoken** library in Node.js.
* Used to **create (sign) a new JSON Web Token (JWT)**.
* The token contains **payload data** and is **signed with a secret key** 🔑 (or private key for asymmetric algorithms).

---

## 2️⃣ Syntax

```js
jwt.sign(payload, secretOrPrivateKey, [options, callback])
```

---

## 3️⃣ Parameters

### 🟢 1. `payload`

* The data you want to store inside the token.
* Usually includes user details like `id`, `email`, `role`.
* Example:

  ```js
  { id: user._id, role: "admin" }
  ```

### 🟢 2. `secretOrPrivateKey`

* A **string or buffer** used to sign the token.
* Must be kept **secret** 🔒 (commonly stored in `.env` file as `process.env.JWT_SECRET`).

### 🟢 3. `options` (optional)

* Extra configuration for the token.
* Common options:

  * `expiresIn`: Sets token expiration (e.g., `"1h"`, `"7d"`).
  * `algorithm`: Signing algorithm (default: `HS256`).
  * `issuer`: Who issued the token.
  * `audience`: Who the token is intended for.

Example:

```js
{ expiresIn: "2h", issuer: "myApp" }
```

### 🟢 4. `callback` (optional)

* If provided, `jwt.sign()` works **asynchronously**.
* If not, it works **synchronously**.

Example (async):

```js
jwt.sign(payload, secret, options, (err, token) => {
  if (err) throw err;
  console.log(token);
});
```

---

## 4️⃣ Example Usage

### ✅ Synchronous

```js
const token = jwt.sign(
  { id: user._id }, 
  process.env.JWT_SECRET, 
  { expiresIn: "1h" }
);
console.log(token);
```

### ✅ Asynchronous

```js
jwt.sign(
  { id: user._id }, 
  process.env.JWT_SECRET, 
  { expiresIn: "1h" }, 
  (err, token) => {
    if (err) throw err;
    console.log(token);
  }
);
```

---

## 5️⃣ How the Token is Structured

A JWT looks like this:

```
header.payload.signature
```

* **Header** → Algorithm & type (`HS256`, `JWT`).
* **Payload** → Your data (`{ id: user._id }`).
* **Signature** → Verifies the token was not tampered with.

---

## 6️⃣ Why Use `jwt.sign()`?

✅ Creates secure, tamper-proof tokens.
✅ Stateless authentication (no need for session storage).
✅ Tokens can expire (`expiresIn`) for better security.
✅ Easy to send in HTTP headers (`Authorization: Bearer <token>`).

---

# ✨ Final Note

👉 `jwt.sign()` is like giving your user a **digital passport 🛂**.
It contains their identity (**payload**) and a special seal (**signature**) made with your secret key 🔐.
Only the server can verify this seal later using `jwt.verify()`.

---