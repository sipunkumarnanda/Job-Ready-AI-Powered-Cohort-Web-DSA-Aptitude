
# ğŸ¤–ğŸ’» MCP Client & Google GenAI Integration â€“ Step by Step ğŸ› ï¸âœ¨

# ğŸ“ `mcp.client.js`

```javascript
import { Client } from "@modelcontextprotocol/sdk/client/index.js";
import { StdioClientTransport } from "@modelcontextprotocol/sdk/client/stdio.js";
import { GoogleGenAI, Type } from "@google/genai";
import dotenv from 'dotenv'

dotenv.config()
const ai = new GoogleGenAI({});

const tools = []

const transport = new StdioClientTransport({
    command : "node",
    args : ["./mcp.server.js"]
})

const client = new Client(
  {
    name: "example-client",
    version: "1.0.0"
  }
);

await client.connect(transport);

const response = await client.listTools();
response.tools.forEach((tool) => {
  tools.push({
    name: tool.name,
    description: tool.description,
    parameters: {
      type: "OBJECT",  
      properties: tool.inputSchema.properties,
      required: tool.inputSchema.required || []
    }
  });
});

// Send request with function declarations
const aiResponse = await ai.models.generateContent({
  model: 'gemini-2.0-flash',
  contents: "Add 2 and 3",
  config: {
    tools: [{
      functionDeclarations: tools
    }],
  },
});

console.log("AI Response : " , aiResponse.functionCalls);

aiResponse.functionCalls.forEach(async(call)=>{
   const toolResponse = await client.callTool({
        name : call.name,
        arguments : call.args
    })

    console.log("Tool Response : ", toolResponse);
})
```

---

# ğŸ“¦ 1ï¸âƒ£ Imports

```javascript
import { Client } from "@modelcontextprotocol/sdk/client/index.js";
import { StdioClientTransport } from "@modelcontextprotocol/sdk/client/stdio.js";
import { GoogleGenAI, Type } from "@google/genai";
import dotenv from 'dotenv'
```

**Explanation:**

* `Client`: Main class to **create an MCP client** that talks to the server. ğŸ–¥ï¸
* `StdioClientTransport`: Handles communication with the MCP server via **stdin/stdout**. ğŸ”„
* `GoogleGenAI`: SDK to interact with **Googleâ€™s generative AI** models. ğŸ¤–
* `dotenv`: Loads environment variables from a `.env` file. Useful for API keys, secrets, or configs. ğŸŒ±

---

# âš¡ 2ï¸âƒ£ Initialize Environment & AI

```javascript
dotenv.config()
const ai = new GoogleGenAI({});
```

**Explanation:**

* `dotenv.config()`: Loads environment variables into `process.env`.
* `ai = new GoogleGenAI({})`: Creates an instance of Google GenAI for generating AI responses.
* This allows your client to **query an AI model** dynamically. ğŸ’¡

---

# ğŸ› ï¸ 3ï¸âƒ£ Prepare MCP Client Transport

```javascript
const transport = new StdioClientTransport({
    command : "node",
    args : ["./mcp.server.js"]
})
```

**Explanation:**

* Defines **how the client will communicate with the server**.
* `command: "node"` â†’ Runs the server using Node.js.
* `args: ["./mcp.server.js"]` â†’ Points to the server file.
* Essentially, this **launches the MCP server process** and pipes communication through stdin/stdout. ğŸš€

---

# ğŸ–¥ï¸ 4ï¸âƒ£ Create MCP Client

```javascript
const client = new Client(
  {
    name: "example-client",
    version: "1.0.0"
  }
);

await client.connect(transport);
```

**Explanation:**

* Creates a new MCP client instance with a name and version.
* `client.connect(transport)` â†’ Connects the client to the server via the transport defined above.
* Now the client can **list tools and call them**. ğŸ—‚ï¸

---

# ğŸ” 5ï¸âƒ£ Fetch Tools from Server

```javascript
const response = await client.listTools();
response.tools.forEach((tool) => {
  tools.push({
    name: tool.name,
    description: tool.description,
    parameters: {
      type: "OBJECT",  
      properties: tool.inputSchema.properties,
      required: tool.inputSchema.required || []
    }
  });
});
```

**Explanation:**

* `client.listTools()` â†’ Fetches all tools registered on the server. ğŸ› ï¸
* For each tool, we create a **function declaration object** for AI to understand:

  * `name` â†’ Tool name.
  * `description` â†’ Tool purpose.
  * `parameters` â†’ Input schema (`properties` & `required`).
* This allows the AI model to **call server tools correctly**. âœ…

---

# ğŸ¤– 6ï¸âƒ£ Ask AI to Use Tools

```javascript
const aiResponse = await ai.models.generateContent({
  model: 'gemini-2.0-flash',
  contents: "Add 2 and 3",
  config: {
    tools: [{
      functionDeclarations: tools
    }],
  },
});
```

**Explanation:**

* Sends a request to the AI model: `"Add 2 and 3"`. ğŸ§®
* Configures the AI with **tool declarations**, so the AI knows which functions it can call.
* AI decides **which tool to invoke** and with what arguments. âš¡

---

# ğŸ“ 7ï¸âƒ£ Inspect AI Response

```javascript
console.log("AI Response : " , aiResponse.functionCalls);
```

**Explanation:**

* Logs **what the AI decided to call**.
* `aiResponse.functionCalls` contains:

  * `name` â†’ tool name to invoke.
  * `args` â†’ arguments for the tool.
* Lets you see AI reasoning before actually calling the tool. ğŸ‘€

---

# ğŸ”— 8ï¸âƒ£ Call Tool via Client

```javascript
aiResponse.functionCalls.forEach(async(call)=>{
   const toolResponse = await client.callTool({
        name : call.name,
        arguments : call.args
    })

    console.log("Tool Response : ", toolResponse);
})
```

**Explanation:**

* Loops through each function call suggested by the AI. ğŸ”„
* `client.callTool({ name, arguments })` â†’ Executes the tool on the server.
* Prints the **actual tool response**, e.g., `5` for `"Add 2 and 3"`. âœ…
* This completes the **AI â†’ MCP client â†’ MCP server â†’ AI** loop. ğŸŒ

---

# âš¡ Summary

* Imports MCP Client SDK and Google GenAI.
* Connects to the MCP server using **Stdio transport**.
* Fetches **available tools** from the server.
* Sends a request to **Google GenAI** with tools it can call.
* AI returns **function calls**, which the client executes on the server.
* Prints both **AI's intended function calls** and **actual tool outputs**. ğŸš€

---